[原视频地址(油管地址)](https://www.youtube.com/watch?v=IvsANO0qZEg)

## RPC

一般基于 RPC 协议所设计的接口，是基于网络采用客户端/服务端的模式完成调用接口的

优点

- 简单并且易于理解（面向开发者）
- 轻量级的数据载体
- 高性能

缺点

- 对于系统本身耦合性高
- 因为 RPC 本身很简单、轻量，因此很容易造成`function explosion`

高耦合意味着调用者必须要足够了解系统本身的实现才能够完成调用，比如：

- 调用者需要知道所调用接口的函数名、参数格式、参数顺序、参数名称等等
- 如果接口提供者(server)要对接口做出一些改变，很容易对接口调用者(client)造成`breaking change`（违背开闭原则)
- 一般 RPC 所暴露接口仅仅会暴露函数的名称和参数等信息，对于函数之间的调用关系无法提供，这意味着调用者必须足够了解系统，从能够知道如何正确的调用这些接口，但是对于接口调用者往往不需要了解过多系统内部实现细节

关于上面的第二点，为了减少`breaking change`，我之前实现接口的时候一般都会引入版本的概念，就是在暴露接口的方法名中加入版本号，一开始效果确实不错，但是随后就不知不觉的形成了`function explosion`，和视频中主讲人所举例的例子差不多，贴一下视频中的截图感受一波：

![functionexplosion](/docs/concept/functionexplosion.png)

## REST

当前 REST 风格的 API 架构方式已经成了主流解决方案了，相比较 RPC 它的主要不同之处在于，它是**对于资源(Resource)的模型化而非步骤(Procedure)**

优点

- 对于系统本身耦合性低，调用者不再需要了解接口内部处理和实现细节
- 重复使用了一些 http 协议中的已定义好的部分状态动词，增强语义表现力
- API 可以随着时间而不断演进

缺点

- 缺少约束，缺少简单、统一的规范
- 有时候 payload 会变的冗余(overload)，有时候调用 api 会比较繁琐(chattiness)
- 有时候需要发送多条请求以获取数据，在网络带宽较低的场景，往往会造成不好的影响

REST 的优点基本解决了 RPC 中存在的问题，就是解耦，从而使得前后端分离成为可能。接口提供者在修改接口时，不容易造成 breaking-change，接口调用者在调用接口时，往往面向数据模型编程，而省去了了解接口本身的时间成本。

但是，我认为 REST 当前最大的问题在于虽然它利用 http 的动词约束了接口的暴露方式，同时增强了语义，但是却没有约束接口如何返回数据的最佳实践，总让人感觉只要是返回 json 格式的接口都可以称作 REST。

我在实际工作中，经常会遇到第二条缺点所指出的问题，就是接口返回的数据冗余度很高，但是却缺少我真正需要的数据，因此不得已只能调用其他接口或者直接和后端商议修改接口，并且这种问题会在 web 端和移动端共用一套接口中被放大。

当前比较好的解决方案就是规范化返回数据的格式，比如 json-schema 或者自己制定的规范。

## GraphQL

GraphQL 是近来比较热门的一个技术话题，相比 REST 和 RPC，它汲取了两者的优点，即不面向资源，也不面向过程，而是面向数据查询(ask for exactly what you want)。

同时 GraphQL 本身需要使用强类型的 Schema 来对数据模型进行定义，因此相比 REST 它的约束性更强。

优点

- 网络开销低，可以在单一请求中获取 REST 中使用多条请求获取的资源
- 强类型 Schema（约束意味着可以根据规范形成文档、IDE、错误提示等生态工具）
- 特别适合图状数据结构的业务场景（比如好友、流程、组织架构等系统）

缺点

- 本身的语法相比较 REST 和 RPC 均复杂一些
- 实现方面需要配套 Caching 以解决性能瓶颈
- 对于 API 的版本控制当前没有完善解决方案（社区的建议是不要使 API 版本化）
- 仍然是新鲜事物，很多技术细节仍然处于待验证状态

鉴于 GraphQL 这两个星期我也仅仅是做了一些简单地使用和了解，仅仅说一下感受。

首先值得肯定的是，在某些程度上确实解决了 REST 的缺点所带来的问题，同时配套社区建议的各种工具和库，相比使用 REST 风格，全栈开发体验上升一个台阶。

但是这个看起来很好的东西为什么没有火起来呢？我觉的最主要的原因是因为 GraphQL 所带来的好处，大部分是对于接口调用者而言的，但是实现这部分的工作却需要接口提供者来完成。

同时 GraphQL 的最佳实践场景应当是类似像 Facebook 这样的网站，业务逻辑模型是图状数据结构，比如社交。如果在一些业务逻辑模型相对简单的场景，使用 GraphQL 确实不如使用 REST 来得简单明了、直截了当。

另外一方面是 GraphQL 的使用场景相当灵活，在我自己的调研项目中，我是把它当做一个类似 ORM 的框架来使用的，在别人的一些文章中，会把它当做一个中间层来做渐进式开发和系统升级。这应当算是另外一个优点。

[RPC vs REST vs GraphQL](https://segmentfault.com/a/1190000013961872)
