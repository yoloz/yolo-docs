"use strict";(self.webpackChunkyolo_docs=self.webpackChunkyolo_docs||[]).push([[7602],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var a=n(67294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var i=a.createContext({}),u=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(i.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(n),m=l,f=c["".concat(i,".").concat(m)]||c[m]||d[m]||r;return n?a.createElement(f,o(o({ref:t},p),{},{components:n})):a.createElement(f,o({ref:t},p))}));function f(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,o=new Array(r);o[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[c]="string"==typeof e?e:l,o[1]=s;for(var u=2;u<r;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},32126:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var a=n(87462),l=(n(67294),n(3905));const r={},o=void 0,s={unversionedId:"tools/CVEScannerV2",id:"tools/CVEScannerV2",title:"CVEScannerV2",description:"CVEScannerV2",source:"@site/docs/tools/CVEScannerV2.md",sourceDirName:"tools",slug:"/tools/CVEScannerV2",permalink:"/docs/tools/CVEScannerV2",draft:!1,editUrl:"https://github.com/yoloz/yolo-docs/tree/docusaurus/docs/tools/CVEScannerV2.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u914d\u7f6e\u8de8\u57df\u8bbf\u95ee",permalink:"/docs/spring/\u914d\u7f6e\u8de8\u57df\u8bbf\u95ee"},next:{title:"IDE\u5b89\u88c5\u5b57\u4f53",permalink:"/docs/tools/IDE\u5b89\u88c5\u5b57\u4f53"}},i={},u=[{value:"\u51c6\u5907\u6570\u636e",id:"\u51c6\u5907\u6570\u636e",level:2},{value:"sqlite3",id:"sqlite3",level:3},{value:"luasql \u73af\u5883",id:"luasql-\u73af\u5883",level:2},{value:"Lua",id:"lua",level:3},{value:"nmap \u73af\u5883",id:"nmap-\u73af\u5883",level:2},{value:"python \u73af\u5883",id:"python-\u73af\u5883",level:2},{value:"\u8fd0\u884c",id:"\u8fd0\u884c",level:2}],p={toc:u},c="wrapper";function d(e){let{components:t,...n}=e;return(0,l.kt)(c,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/yoloz/CVEScannerV2.git"},"CVEScannerV2")),(0,l.kt)("h2",{id:"\u51c6\u5907\u6570\u636e"},"\u51c6\u5907\u6570\u636e"),(0,l.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7 API \u67e5\u8be2\uff0c\u6b64\u5904\u751f\u6210\u5de5\u7a0b\u91cc\u63d0\u4f9b\u7684\u6570\u636e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"$ git clone https://github.com/yoloz/CVEScannerV2.git\n$ cd CVEScannerV2\n# for convenience, a semi-updated database is offered as .sql format in CVEScannerV2DB.\n$ git submodule init\n$ git submodule update\n$ sudo apt install sqlite3\n$ cd CVEScannerV2DB/\n$ ./build.sh\n")),(0,l.kt)("h3",{id:"sqlite3"},"sqlite3"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'$ sqlite3\n# SQLite version 3.22.0 2018-01-22 18:45:57\n# Enter ".help" for usage hints.\n# Connected to a transient in-memory database.\n# Use ".open FILENAME" to reopen on a persistent database.\n# sqlite> .exit\n')),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("inlineCode",{parentName:"p"},".exit"),"\u9000\u51fa\u4ea4\u4e92\u6a21\u5f0f")),(0,l.kt)("h2",{id:"luasql-\u73af\u5883"},"luasql \u73af\u5883"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo apt install lua-sql-sqlite3\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e0b\u9762\u65b9\u5f0f\u5b89\u88c5 luasql-sqlite3 \u540e nmap \u811a\u672c\u627e\u4e0d\u5230 sqlite3")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u627e\u4e0d\u5230\u6a21\u5757 luasql.sqlite3\n$ nmap -sV <target_ip> -p10001 --script ./cvescannerv2.nse --script-args db=./CVEScannerV2DB/cve.db\n# Starting Nmap 7.60 ( https://nmap.org ) at 2024-03-19 19:00 CST\n# NSE: Failed to load /xxx/CVEScannerV2/cvescannerv2.nse:\n# /xxx/CVEScannerV2/cvescannerv2.nse:74: module 'luasql.sqlite3' not found:\n#   NSE failed to find nselib/luasql/sqlite3.lua in search paths.\n#   no field package.preload['luasql.sqlite3']\n#   no file '/usr/local/share/lua/5.3/luasql/sqlite3.lua'\n#   no file '/usr/local/share/lua/5.3/luasql/sqlite3/init.lua'\n#   no file '/usr/local/lib/lua/5.3/luasql/sqlite3.lua'\n#     ....\n$ lua\n# Lua 5.4.6  Copyright (C) 1994-2023 Lua.org, PUC-Rio\n> sqlite3=require 'luasql.sqlite3'\n> print(sqlite3._VERSION)\n# LuaSQL 2.6.0 (for Lua 5.4)\n# > os.exit()\n\n")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://luarocks.org/"},"LuaRocks")," is the package manager for Lua modules.\n",(0,l.kt)("a",{parentName:"p",href:"https://lunarmodules.github.io/luasql/"},"luasql")," is a simple interface from Lua to a DBMS."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"$ wget https://luarocks.org/releases/luarocks-3.11.0.tar.gz\n$ tar zxpf luarocks-3.11.0.tar.gz\n$ cd luarocks-3.11.0\n$ ./configure && make && sudo make install\n# $ luarocks install luasql-sqlite3\n# Error: Could not find header file for SQLITE\n#   No file sqlite3.h in /usr/local/include\n#   No file sqlite3.h in /usr/include\n#   No file sqlite3.h in /include\n# You may have to install SQLITE in your system and/or pass SQLITE_DIR or SQLITE_INCDIR to the luarocks command.\n# Example: luarocks install luasql-sqlite3 SQLITE_DIR=/usr/local\n$ sudo apt install libsqlite3-dev\n$ sudo find / -name sqlite3.h\n# /usr/include/sqlite3.h\n$ sudo luarocks install luasql-sqlite3\n")),(0,l.kt)("h3",{id:"lua"},"Lua"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.lua.org/"},"Lua")," is implemented in pure ANSI C and compiles unmodified in all platforms that have an ANSI C compiler."),(0,l.kt)("p",null,"\u5efa\u8bae\u76f4\u63a5\u5b89\u88c5\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"sudo apt install lua"),",\u6e90\u7801\u5b89\u88c5\u5982\u4e0b:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"$ curl -L -R -O https://www.lua.org/ftp/lua-5.4.6.tar.gz\n$ tar zxf lua-5.4.6.tar.gz\n$ cd lua-5.4.6\n$ make all test\n$ lua\n# Lua 5.4.6  Copyright (C) 1994-2023 Lua.org, PUC-Rio\n# > os.exit()\n# \u5728\u4ea4\u4e92\u5f0fLua\u4e2d\u7ed3\u675f\u4f1a\u8bdd\u4f7f\u7528os.exit()\uff0c\u6ca1\u6709quit\u5173\u952e\u5b57\n")),(0,l.kt)("h2",{id:"nmap-\u73af\u5883"},"nmap \u73af\u5883"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo apt install nmap\n")),(0,l.kt)("h2",{id:"python-\u73af\u5883"},"python \u73af\u5883"),(0,l.kt)("p",null,"\u7565"),(0,l.kt)("h2",{id:"\u8fd0\u884c"},"\u8fd0\u884c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u67e5\u770b\u60f3\u8d77\u4fe1\u606f\u6dfb\u52a0-d\n$ nmap -sV 192.168.124.251 -p10001 -d --script ./cvescannerv2.nse --script-args http=0,db=./CVEScannerV2DB/cve.db,product-aliases=./product-aliases.json\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"variable 'format_timestamp' is not declared\n\u67e5\u770b\u811a\u672c\uff1a",(0,l.kt)("inlineCode",{parentName:"li"},"registry.time = datetime.format_timestamp(os.time(), 0)"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"$ lua\nLua 5.4.6  Copyright (C) 1994-2023 Lua.org, PUC-Rio\n> datetime = require 'datetime'\nstdin:1: module 'datetime' not found:\n    no field package.preload['datetime']\n    no file '/usr/local/share/lua/5.4/datetime.lua'\n    ...\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u672a\u627e\u5230 datetime \u6a21\u5757\uff0c\u4fee\u6539\u811a\u672c",(0,l.kt)("inlineCode",{parentName:"p"},'registry.time = os.date("%Y-%m-%d %H:%M:%S", os.time())'))))}d.isMDXComponent=!0}}]);