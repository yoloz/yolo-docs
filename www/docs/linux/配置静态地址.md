## ubuntu

该方法 ubuntu 18.04 失效

修改配置文件 _/etc/network/interfaces_

```log
auto eth0                  #设置自动启动eth0接口
iface eth0 inet static     #配置静态IP
address 192.168.11.88      #IP地址
netmask 255.255.255.0      #子网掩码
gateway 192.168.11.1       #默认网关
```

重启网络，使配置生效`$ sudo /etc/init.d/networking restart`
查看 ip 是否配置成功 `$ ifconfig`

### ubuntu 18.04

在 Ubuntu 18.04 中如果再通过原来的 ifupdown 工具包继续在 /etc/network/interfaces 文件里配置管理网络接口是无效的。

1. 查看网关地址`route -n`

```bash
user@ubuntu:~$ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.1.1     0.0.0.0         UG    100    0        0 enp0s3
169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 enp0s3
192.168.1.0     0.0.0.0         255.255.255.0   U     100    0        0 enp0s3
```

2. 使用[Netplan](../network/netplan)配置静态 ip

修改 _/etc/netplan/50-cloud-init.yaml_ 文件 ，桌面版的是 _/etc/netplan/01-network-manager-all.yaml_ 修改为

```yaml
network:
  ethernets:
    ens33:
      addresses: [192.168.36.202/24]
      gateway4: 192.168.36.1
      dhcp4: no
      nameservers:
        addresses: [114.114.114.114, 180.76.76.76]
  version: 2
```

:::note

- ens33 是网卡名称
- gateway4 配置为`route -n`查看到的网关
- dhcp4 no 代表不是用 dhcp 动态获取 ip，yes 代表使用 dhcp 动态获取 ip
- nameservers dns 地址

:::

使得配置文件生效`netplan apply`

## centos

修改 _/etc/sysconfig/network-scripts/ifcfg-网卡_ 文件

```log
BOOTPROTO=static          #静态ip
IPADDR=192.168.1.20       #IP地址
NETMASK=255.255.255.0     #子网掩码
GATEWAY=192.168.1.1       #默认网关
DNS1=192.168.1.1          #DNS服务器
ONBOOT=yes                #是否激活网卡
```

使得配置生效 `systemctl restart network`(centos7) `service network restart`(centos6)

**注意**

- 克隆出一台新的虚拟机需要通过虚拟机管理工具删除旧的网络生成新的网络,否则 mac 冲突。

- yum install 报错 Cannot find a valid baseurl for repo: base/7/x86_64，需要在网卡文件中添加 DNS

```log
DNS1=114.114.114.114
DNS2=8.8.8.8
```

### 配置静态路由

- 临时配置

`ip route add 192.168.100.0/24 via 172.16.16.254 dev eth0`
此时，访问 192.168.100.0/24 网段，将通过 eth0 网卡转出，下一跳指向 172.16.16.254。**临时添加路由的方法无需重启网卡，立即生效，但是如果对网卡进行了重启，临时路由会立即丢失**

- 永久配置

在`/etc/sysconfig/network-scripts/`目录下创建`route-eth*`配置文件，其中 eth\*为对应的网卡编号，即静态路由的出口网卡，该配置文件中的路由出口信息，必须与此文件名编号一致。

```log
#cat /etc/sysconfig/network-scripts/route-eth0
192.168.101.0/24 via 172.16.16.254 dev eth0
192.168.102.0/24 via 172.16.16.254 dev eth0
192.168.103.0/24 via 172.16.16.254 dev eth0

#查看路由信息
[root@server]# route -n
Kernel IP routing table
Destination      Gateway          Genmask        Flags     Metric     Ref    Use Iface
0.0.0.0         192.168.3.254     0.0.0.0        UG　　     100　　　　　0      0　　eth1
172.16.0.0      0.0.0.0           255.255.0.0    U　　      100　　　　　0      0　　eth0
192.168.3.0     0.0.0.0           255.255.255.0  U　　      100　　　　　0      0　　eth1
192.168.101.0   172.16.16.254　　　255.255.255.0  UG　　     100　　　　　0      0　　eth0
192.168.102.0   172.16.16.254　　　255.255.255.0  UG 　　    100　　　　　0      0　　eth0
192.168.103.0   172.16.16.254　　　255.255.255.0  UG　　     100　　　　　0      0　　eth0
```
