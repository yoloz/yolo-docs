## 查看

查看 linux 下的硬盘挂载的空间、使用空间`df -h`,查看不到未挂在的硬盘，可以使用`lsblk`列出块设备信息或者`fdisk -l`查看，也可以去 dev 目录查看`ls /dev/sd*`。

![disk2](/docs/linux/disk2.png)

## 分区

[Linux 中直接挂载硬盘和挂载分区有什么区别](https://blog.csdn.net/wanglei9876/article/details/46968279/)

假设新增的硬盘是 sdb`fdisk /dev/sdb`

新建分区选择 n

![disk1](/docs/linux/disk1.png)

1. 建立主分区 p;
2. MBR 分区只能有 4 个分区，这里建立第一个分区，输入 1;
3. 选择起始扇区，这里直接回车（默认），相当于输入了 2048;
4. 选择结束扇区，这里只创建一个分区，直接回车。此时一个分区已经建立，但还是在内存中并没有写到硬盘 sdb 中，所以直接输入 w。如果结束扇区非默认值且还要创建分区这里可以继续创建分区输入 n，最后完了再输入 w。

![disk3](/docs/linux/disk3.png)

**内核重新读取分区表**`sudo partprobe /dev/sdb`，这里是整个磁盘 sdb，不是磁盘分区 sdb1。

> partprobe 可以使 kernel 重新读取分区信息，从而避免重启系统

## 创建文件系统(格式化分区)

![disk4](/docs/linux/disk4.png)

`sudo mkfs -t ext4 /dev/sdb1`这里是磁盘分区 sdb1，不是整个磁盘 sdb

## 挂载

临时性挂载`sudo mount /dev/sdb1 /mnt/data/`,挂在目录/mnt/data 不存在则需要创建。

**永久挂载**编辑文件/etc/fstab

![disk5](/docs/linux/disk5.png)

- file system  
  硬盘路径也可以写入 UUID,UUID 的查询`blkid`。
- mount point  
  文件路径（挂载点）
- type  
  文件系统类型
- options  
  设备的自定义选项
- dump  
  是否转存,0:不转存,不备份;1:转存,备份
- pass  
  fsck 的顺序(开机检查磁盘的顺序),0 表示不检查,1234....为检查顺序

**以上步骤完成后，还需要判断是否正确**`sudo mount -a`，如果没有其他信息出现，表示你插入的正确，否则错误。如果错误且没有检查，开机后将进入紧急模式，无法开机。

将/opt 以及用户目录转移到新增的硬盘上去(挂在`/data`)

```bash
sudo rm -rf /opt
sudo mkdir /data/opt
sudo mkdir /data/yoloz
sudo ln -s /data/opt /opt
sudo cp -r ~/. /data/yoloz #“~/*”不会拷贝隐藏文件
sudo vim /etc/passwd #修改其中的路径/home/yoloz为/data/yoloz
sudo rm -rf /home/yoloz
```
