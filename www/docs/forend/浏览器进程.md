浏览器包含以下进程：

- Browser 进程
- 第三方插件进程
- GPU 进程（Graphics Processing User）
- 渲染进程

> 浏览器如果是单进程，那么某个 tab 页崩溃，某个插件崩溃等都会导致浏览器崩溃；

## 渲染进程

页面渲染，JS 的执行，事件的循环，都在渲染进程中执行，渲染进程是多线程的，以下是一些常用的线程：

### GUI 渲染线程

- 负责渲染浏览器界面，解析 html，css，构建 DOM 树和 RenderObject 树，布局和绘制等

::: info

1. 解析 html 代码转化为浏览器认识的节点，生成 DOM 树;
2. 解析 CSS，生成 CSSOM（CSS 规则树）;
3. 把 DOM Tree 和 CSSOM 结合，生成 Rendering Tree（渲染树）;

:::

- 当修改元素的颜色或背景色时，页面会重绘;
- 当修改元素尺寸时，页面会回流;
  > 当页面需要重绘和回流时，执行 GUI 线程，绘制页面  
  > 回流比重绘成本高

**GUI 渲染线程和 JS 引擎线程是互斥的**:

> 当 JS 引擎线程执行时，GUI 渲染线程会被挂起;  
> GUI 渲染线程会被保存在一个队列中等到 JS 引擎空闲时立即被执行

### JS 引擎线程

- JS 引擎线程就是 JS 内核，负责处理 Javascript 脚本程序
- JS 引擎线程负责解析 Js 脚本，运行代码
- JS 引擎线程一直等待队列中的任务到来，然后执行
- JS 引擎线程和 GUI 渲染线程是互斥的，js 引擎线程会阻塞 GUI 渲染线程

### 事件触发线程

- 事件触发线程管理着一个事件队列，用来控制事件循环
- 当 js 执行碰到事件绑定或一些异步操作时，会交由事件触发线程将对应的事件添加到对应的线程中（如定时器事件会添加到定时触发器线程中），等异步事件有了结果，便把结果添加到事件队列中，等待 js 引擎线程空闲时来处理。
- 当对应的事件符合触发条件触发时，该线程会将事件添加到事件队列的队尾，等待 JS 引擎处理
- 因为 JS 是单线程，所以待处理队列中的事件都得排队等 JS 引擎处理

### 定时触发器线程

当 JS 代码执行中遇到定时任务（如 setTimeout、setInterval），会将该定时器任务交由定时触发线程处理，然后等计时完毕，便将事件添加至事件触发线程的事件队列中，等待 JS 引擎空闲后处理

### 异步 HTTP 请求线程

当 JS 代码执行过程中，若遇到 http 异步请求，则将该异步请求事件交由异步 http 请求线程，等异步事件响应成功后（即状态码变更），再将事件添加至事件触发线程的事件队列中等待 JS 引擎空闲后处理
